<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>USå·ç ç®¡å®¶ - ä¼ä¸šçº§å·ç ç®¡ç†å¹³å°</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* å…¨å±€åŸºç¡€æ ·å¼ä¸ä¸»é¢˜å˜é‡ */
    :root {
      --primary: #409eff;
      --primary-light: #e6f7ff;
      --primary-dark: #1890ff;
      --success: #52c41a;
      --success-light: #f6ffed;
      --warning: #faad14;
      --warning-light: #fffbe6;
      --danger: #ff4d4f;
      --danger-light: #fff2f0;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --text-tertiary: #9ca3af;
      --border: #e5e7eb;
      --bg-light: #f9fafb;
      --bg-white: #ffffff;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
      --shadow: 0 2px 8px rgba(0,0,0,0.08);
      --shadow-lg: 0 4px 16px rgba(0,0,0,0.12);
      --radius-sm: 6px;
      --radius: 8px;
      --radius-lg: 12px;
      --transition: all 0.25s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', 'system-ui', 'å¾®è½¯é›…é»‘', sans-serif;
    }

    body {
      background-color: var(--bg-light);
      color: var(--text-primary);
      line-height: 1.5;
      font-size: 14px;
      padding: 0;
      min-height: 100vh;
    }

    /* é¡µé¢å®¹å™¨ä¸å¸ƒå±€ */
    .app-container {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 240px;
      background-color: var(--bg-white);
      border-right: 1px solid var(--border);
      padding: 1.5rem 0;
      display: flex;
      flex-direction: column;
      transition: var(--transition);
      z-index: 100;
    }

    .sidebar.collapsed {
      width: 64px;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .content-wrapper {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
    }

    /* é¡µé¢åˆ‡æ¢åŠ¨ç”» */
    .page {
      display: none;
      animation: fadeIn 0.3s ease forwards;
    }

    .page.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* å¡ç‰‡ä¸å®¹å™¨æ ·å¼ */
    .card {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      padding: 1.25rem;
      margin-bottom: 1.25rem;
      transition: var(--transition);
    }

    .card:hover {
      box-shadow: var(--shadow-lg);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border);
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* æŒ‰é’®æ ·å¼å‡çº§ */
    .btn {
      padding: 8px 16px;
      border-radius: var(--radius);
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: var(--transition);
      height: 36px;
      min-width: 80px;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-primary {
      background-color: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--primary-dark);
    }

    .btn-success {
      background-color: var(--success);
      color: white;
    }

    .btn-success:hover {
      background-color: #4aa918;
    }

    .btn-warning {
      background-color: var(--warning);
      color: white;
    }

    .btn-warning:hover {
      background-color: #e69c00;
    }

    .btn-danger {
      background-color: var(--danger);
      color: white;
    }

    .btn-danger:hover {
      background-color: #e04344;
    }

    .btn-default {
      background-color: var(--bg-white);
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-default:hover {
      background-color: var(--bg-light);
    }

    .btn-sm {
      padding: 4px 12px;
      height: 32px;
      font-size: 13px;
      min-width: auto;
    }

    .btn-icon {
      width: 36px;
      height: 36px;
      padding: 0;
      min-width: auto;
      border-radius: 50%;
    }

    /* è¾“å…¥æ¡†ä¸é€‰æ‹©å™¨ä¼˜åŒ– */
    .input, .select, .textarea {
      padding: 8px 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      font-size: 14px;
      width: 100%;
      transition: var(--transition);
      height: 36px;
      background-color: var(--bg-white);
    }

    .textarea {
      min-height: 80px;
      resize: vertical;
      line-height: 1.5;
      padding-top: 10px;
    }

    .input:focus, .select:focus, .textarea:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .input-search {
      flex: 1;
      max-width: 400px;
      position: relative;
    }

    .input-search::placeholder {
      color: var(--text-tertiary);
    }

    .form-row {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    .form-col {
      flex: 1;
      min-width: 200px;
    }

    /* é¡¶éƒ¨å¯¼èˆªæ  */
    .header {
      height: 64px;
      background-color: var(--bg-white);
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 1.5rem;
      box-shadow: var(--shadow-sm);
      z-index: 90;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 18px;
      font-weight: 600;
      color: var(--primary);
    }

    .logo-icon {
      width: 36px;
      height: 36px;
      background-color: var(--primary);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 18px;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 12px;
      border-radius: 18px;
      background-color: var(--bg-light);
      cursor: pointer;
      transition: var(--transition);
    }

    .user-info:hover {
      background-color: var(--primary-light);
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: var(--primary-light);
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    /* ä¾§è¾¹æ å¯¼èˆª */
    .sidebar-menu {
      list-style: none;
      margin-top: 1.5rem;
    }

    .sidebar-menu-item {
      margin-bottom: 4px;
    }

    .sidebar-menu-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 1.25rem;
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      border-left: 3px solid transparent;
      transition: var(--transition);
    }

    .sidebar-menu-link:hover {
      background-color: var(--bg-light);
      color: var(--primary);
    }

    .sidebar-menu-link.active {
      background-color: var(--primary-light);
      color: var(--primary);
      border-left-color: var(--primary);
    }

    .sidebar-menu-icon {
      font-size: 18px;
      width: 20px;
      text-align: center;
    }

    .sidebar-collapse {
      margin-top: auto;
      display: flex;
      justify-content: center;
      padding: 12px;
    }

    .sidebar-collapse-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: var(--bg-light);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      color: var(--text-secondary);
    }

    .sidebar-collapse-btn:hover {
      background-color: var(--primary-light);
      color: var(--primary);
    }

    /* ç­›é€‰åŒºä¼˜åŒ– */
    .filter-bar {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 1rem;
      padding: 0.75rem 1rem;
      background-color: var(--bg-white);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .filter-actions {
      display: flex;
      gap: 0.5rem;
      margin-left: auto;
    }

    .saved-filters {
      position: relative;
    }

    .saved-filters-btn {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      width: 200px;
      background-color: var(--bg-white);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      margin-top: 4px;
      z-index: 10;
      overflow: hidden;
      display: none;
    }

    .filter-dropdown.show {
      display: block;
      animation: fadeIn 0.2s ease forwards;
    }

    .filter-dropdown-item {
      padding: 8px 12px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .filter-dropdown-item:hover {
      background-color: var(--primary-light);
      color: var(--primary);
    }

    .filter-dropdown-divider {
      height: 1px;
      background-color: var(--border);
      margin: 4px 0;
    }

    /* è¡¨æ ¼æ ·å¼å‡çº§ */
    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .table-wrapper {
      overflow-x: auto;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background-color: var(--bg-white);
    }

    .table th, .table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
      transition: var(--transition);
    }

    .table th {
      background-color: var(--bg-light);
      font-weight: 600;
      color: var(--text-secondary);
      position: relative;
      user-select: none;
    }

    .table th:hover {
      background-color: #f1f5f9;
    }

    .table th.sortable {
      cursor: pointer;
      padding-right: 24px;
    }

    .table th.sortable::after {
      content: "\f0dc";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      position: absolute;
      right: 10px;
      font-size: 12px;
      color: var(--text-tertiary);
    }

    .table th.sort-asc::after {
      content: "\f0de";
      color: var(--primary);
    }

    .table th.sort-desc::after {
      content: "\f0dd";
      color: var(--primary);
    }

    .table tr:hover {
      background-color: var(--primary-light);
    }

    .table tr:last-child td {
      border-bottom: none;
    }

    .phone-number {
      font-family: 'SFMono-Regular', Consolas, monospace;
      color: var(--text-primary);
      font-weight: 500;
    }

    /* çŠ¶æ€æ ‡ç­¾æ ·å¼ */
    .status-tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .status-used {
      background-color: var(--success-light);
      color: var(--success);
    }

    .status-unused {
      background-color: var(--warning-light);
      color: var(--warning);
    }

    .status-disabled {
      background-color: var(--danger-light);
      color: var(--danger);
    }

    /* æ“ä½œæŒ‰é’®ç»„ */
    .oper-group {
      display: flex;
      gap: 4px;
    }

    .oper-btn {
      color: var(--text-secondary);
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: var(--radius-sm);
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: var(--transition);
    }

    .oper-btn:hover {
      background-color: var(--primary-light);
      color: var(--primary);
    }

    .oper-btn-danger {
      color: var(--danger);
    }

    .oper-btn-danger:hover {
      background-color: var(--danger-light);
      color: var(--danger);
    }

    /* ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡ */
    .stats-container {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.25rem;
      flex-wrap: wrap;
    }

    .stat-card {
      flex: 1;
      min-width: 200px;
      background-color: var(--bg-white);
      border-radius: var(--radius-lg);
      padding: 1rem;
      box-shadow: var(--shadow);
      border-top: 3px solid var(--primary);
      transition: var(--transition);
    }

    .stat-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }

    .stat-card.success {
      border-top-color: var(--success);
    }

    .stat-card.warning {
      border-top-color: var(--warning);
    }

    .stat-card.danger {
      border-top-color: var(--danger);
    }

    .stat-title {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .stat-change {
      font-size: 12px;
      padding: 1px 6px;
      border-radius: 4px;
    }

    .stat-change.positive {
      background-color: var(--success-light);
      color: var(--success);
    }

    .stat-change.negative {
      background-color: var(--danger-light);
      color: var(--danger);
    }

    .stat-desc {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-top: 6px;
    }

    /* è¡¨å•æ ·å¼ä¼˜åŒ– */
    .form {
      max-width: 800px;
      margin: 0 auto;
    }

    .form-item {
      margin-bottom: 1.25rem;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .form-hint {
      margin-top: 5px;
      font-size: 12px;
      color: var(--text-tertiary);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    .form-note {
      color: var(--danger);
      font-size: 12px;
      margin-top: 5px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* æ—¶é—´çº¿æ ·å¼å‡çº§ */
    .timeline {
      position: relative;
      max-width: 800px;
      margin: 0 auto;
      padding-left: 28px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 10px;
      top: 0;
      bottom: 0;
      width: 2px;
      background-color: var(--border);
    }

    .timeline-item {
      position: relative;
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
    }

    .timeline-dot {
      position: absolute;
      left: -28px;
      top: 3px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background-color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 10px;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .timeline-dot.used {
      background-color: var(--success);
      box-shadow: 0 0 0 3px var(--success-light);
    }

    .timeline-dot.unused {
      background-color: var(--warning);
      box-shadow: 0 0 0 3px var(--warning-light);
    }

    .timeline-dot.deleted {
      background-color: var(--danger);
      box-shadow: 0 0 0 3px var(--danger-light);
    }

    .timeline-content {
      background-color: var(--bg-white);
      border-radius: var(--radius);
      padding: 1rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      transition: var(--transition);
    }

    .timeline-content:hover {
      box-shadow: var(--shadow-lg);
      transform: translateX(3px);
    }

    .timeline-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .timeline-time {
      color: var(--text-tertiary);
      font-size: 12px;
    }

    .timeline-action {
      font-size: 12px;
      font-weight: 500;
      padding: 2px 8px;
      border-radius: 4px;
    }

    .timeline-title {
      font-weight: 500;
      margin-bottom: 6px;
    }

    .timeline-detail {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* æç¤ºæ¡†å’ŒåŠ è½½åŠ¨ç”»ä¼˜åŒ– */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      transform: translateX(120%);
      padding: 12px 16px;
      border-radius: var(--radius);
      background-color: rgba(0,0,0,0.8);
      color: white;
      font-size: 14px;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: var(--shadow-lg);
      transition: transform 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
      max-width: 360px;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast-success {
      background-color: var(--success);
      border-left: 4px solid #389e0d;
    }

    .toast-error {
      background-color: var(--danger);
      border-left: 4px solid #cf1322;
    }

    .toast-warning {
      background-color: var(--warning);
      border-left: 4px solid #d48806;
    }

    .toast-info {
      background-color: var(--primary);
      border-left: 4px solid #096dd9;
    }

    .loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255,255,255,0.8);
      z-index: 1001;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 15px;
      backdrop-filter: blur(2px);
    }

    .loading.show {
      display: flex;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid var(--primary-light);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      font-size: 16px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* æ¨¡æ€æ¡†æ ·å¼å‡çº§ */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 2000;
      display: none;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(2px);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-backdrop.show {
      display: flex;
      opacity: 1;
    }

    .modal {
      background-color: var(--bg-white);
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 800px;
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
      transform: translateY(20px) scale(0.98);
      transition: transform 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
    }

    .modal-backdrop.show .modal {
      transform: translateY(0) scale(1);
    }

    .modal-header {
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: var(--text-tertiary);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .modal-close:hover {
      background-color: var(--danger-light);
      color: var(--danger);
    }

    .modal-body {
      padding: 1.25rem;
    }

    .modal-footer {
      padding: 1rem 1.25rem;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    /* å¯¼å…¥æ¨¡æ¿å’Œå¸®åŠ©æ–‡æœ¬ */
    .import-template {
      margin-top: 1rem;
      padding: 1rem;
      background-color: var(--bg-light);
      border-radius: var(--radius);
      font-size: 13px;
      border: 1px solid var(--border);
    }

    .import-template-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .import-fields {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0;
    }

    .import-field {
      padding: 3px 8px;
      background-color: var(--primary-light);
      border-radius: 4px;
      font-size: 12px;
      color: var(--primary);
      font-weight: 500;
    }

    /* äººå‘˜åˆ—è¡¨æ ·å¼ä¼˜åŒ– */
    .person-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .person-card {
      background-color: var(--bg-white);
      border-radius: var(--radius);
      padding: 1rem;
      border: 1px solid var(--border);
      transition: var(--transition);
      display: flex;
      flex-direction: column;
    }

    .person-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary-light);
    }

    .person-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .person-avatar-lg {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background-color: var(--primary-light);
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 600;
    }

    .person-name {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 16px;
    }

    .person-department {
      font-size: 12px;
      color: var(--text-tertiary);
      background-color: var(--bg-light);
      padding: 2px 6px;
      border-radius: 4px;
      display: inline-block;
    }

    .person-info {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .person-info i {
      color: var(--text-tertiary);
      width: 16px;
      text-align: center;
    }

    .person-actions {
      margin-top: auto;
      display: flex;
      justify-content: flex-end;
      gap: 6px;
      padding-top: 0.75rem;
      border-top: 1px dashed var(--border);
    }

    /* å¯¼å…¥æ–¹å¼é€‰é¡¹å¡ */
    .import-tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin-bottom: 1rem;
      position: relative;
    }

    .import-tab {
      padding: 10px 1.25rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: var(--transition);
      font-weight: 500;
      position: relative;
      z-index: 1;
    }

    .import-tab.active {
      color: var(--primary);
    }

    .import-tab-indicator {
      position: absolute;
      bottom: -1px;
      left: 0;
      height: 2px;
      background-color: var(--primary);
      border-radius: 2px 2px 0 0;
      transition: var(--transition);
    }

    .import-tab-content {
      display: none;
      animation: fadeIn 0.3s ease forwards;
    }

    .import-tab-content.active {
      display: block;
    }

    /* ç²˜è´´å¯¼å…¥æ–‡æœ¬åŒºåŸŸ */
    .paste-area {
      width: 100%;
      min-height: 180px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-family: monospace;
      font-size: 13px;
      resize: vertical;
      margin-bottom: 10px;
      line-height: 1.6;
    }

    .paste-area:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .paste-preview {
      margin-top: 1rem;
      max-height: 240px;
      overflow-y: auto;
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }

    .paste-preview-header {
      background-color: var(--bg-light);
      font-weight: 500;
    }

    .paste-preview-row {
      display: grid;
      grid-template-columns: 50px 1fr 1fr 1fr 1fr;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
      transition: var(--transition);
    }

    .paste-preview-row:hover {
      background-color: var(--primary-light);
    }

    .paste-preview-row.error {
      background-color: var(--danger-light);
    }

    .paste-error {
      color: var(--danger);
      font-size: 12px;
      margin-top: 8px;
      padding: 8px;
      background-color: var(--danger-light);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* ä¸»é¢˜åˆ‡æ¢ä¸ä¸ªæ€§åŒ–è®¾ç½® */
    .theme-switch {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 20px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .3s;
      border-radius: 20px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--primary);
    }

    input:checked + .slider:before {
      transform: translateX(20px);
    }

    .settings-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      width: 240px;
      background-color: var(--bg-white);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      margin-top: 4px;
      z-index: 100;
      overflow: hidden;
      display: none;
      animation: fadeIn 0.2s ease forwards;
    }

    .settings-dropdown.show {
      display: block;
    }

    .settings-section {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
    }

    .settings-section:last-child {
      border-bottom: none;
    }

    .settings-title {
      font-size: 13px;
      color: var(--text-tertiary);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .settings-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .settings-item:last-child {
      margin-bottom: 0;
    }

    .settings-label {
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* å“åº”å¼è®¾è®¡ä¼˜åŒ– */
    @media (max-width: 1024px) {
      .sidebar {
        width: 220px;
      }
      
      .stats-container {
        gap: 0.75rem;
      }
      
      .person-list {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        left: -240px;
        height: 100vh;
      }
      
      .sidebar.show {
        left: 0;
      }
      
      .sidebar.collapsed.show {
        left: 0;
        width: 64px;
      }
      
      .main-content {
        width: 100%;
      }
      
      .mobile-header {
        display: flex !important;
      }
      
      .filter-bar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .filter-actions {
        margin-left: 0;
        width: 100%;
        justify-content: flex-end;
      }
      
      .input-search {
        width: 100%;
        max-width: none;
      }
      
      .form-row {
        gap: 0.75rem;
      }
      
      .form-col {
        flex: 0 0 100%;
      }
      
      .stats-container {
        flex-direction: column;
      }
      
      .stat-card {
        min-width: auto;
      }
      
      .paste-preview-row {
        grid-template-columns: 40px 1fr;
        grid-template-rows: auto auto auto auto;
        grid-template-areas:
          "index phone"
          "index name"
          "index age"
          "index assignee";
      }
      
      .paste-preview-row > div:nth-child(1) { grid-area: index; }
      .paste-preview-row > div:nth-child(2) { grid-area: phone; }
      .paste-preview-row > div:nth-child(3) { grid-area: name; }
      .paste-preview-row > div:nth-child(4) { grid-area: age; }
      .paste-preview-row > div:nth-child(5) { grid-area: assignee; }
      
      .header-actions .btn span:not(.fa) {
        display: none;
      }
      
      .header-actions .btn {
        min-width: auto;
        padding: 0 8px;
        gap: 0;
      }
      
      .user-info span {
        display: none;
      }
      
      .user-info {
        padding: 4px;
      }
    }

    /* ç§»åŠ¨ç«¯é€‚é… */
    .mobile-header {
      display: none;
      height: 56px;
      background-color: var(--bg-white);
      border-bottom: 1px solid var(--border);
      align-items: center;
      padding: 0 1rem;
    }

    .mobile-menu-btn {
      background: none;
      border: none;
      font-size: 20px;
      color: var(--text-secondary);
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .mobile-menu-btn:hover {
      background-color: var(--bg-light);
      color: var(--primary);
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 95;
      display: none;
    }

    .overlay.show {
      display: block;
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-light);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--text-tertiary);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-secondary);
    }

    /* å·¥å…·æç¤º */
    .tooltip {
      position: relative;
      display: inline-block;
    }

    .tooltip .tooltip-text {
      visibility: hidden;
      width: 120px;
      background-color: var(--text-primary);
      color: #fff;
      text-align: center;
      border-radius: var(--radius-sm);
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      font-weight: normal;
      box-shadow: var(--shadow);
    }

    .tooltip .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: var(--text-primary) transparent transparent transparent;
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    /* è‡ªå®šä¹‰æ•°é‡è¾“å…¥æ¡†æ ·å¼ */
    .custom-amount-container {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      padding: 10px;
      background-color: var(--primary-light);
      border-radius: var(--radius);
    }
    
    .custom-amount-container.hidden {
      display: none;
    }
    
    .amount-input-group {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }
    
    .amount-input {
      width: 100px !important;
      text-align: center;
    }
    
    .amount-info {
      font-size: 12px;
      color: var(--text-secondary);
      flex: 2;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- ä¾§è¾¹æ å¯¼èˆª -->
    <div class="sidebar" id="sidebar">
      <div class="logo" id="sidebarLogo">
        <div class="logo-icon">ğŸ“</div>
        <span>USå·ç ç®¡å®¶</span>
      </div>
      
      <ul class="sidebar-menu">
        <li class="sidebar-menu-item">
          <a href="javascript:showPage('listPage')" class="sidebar-menu-link active" data-page="listPage">
            <i class="fas fa-list sidebar-menu-icon"></i>
            <span>å·ç ç®¡ç†</span>
          </a>
        </li>
        <li class="sidebar-menu-item">
          <a href="javascript:showPage('personPage')" class="sidebar-menu-link" data-page="personPage">
            <i class="fas fa-users sidebar-menu-icon"></i>
            <span>äººå‘˜ç®¡ç†</span>
          </a>
        </li>
        <li class="sidebar-menu-item">
          <a href="javascript:showPage('statisticsPage')" class="sidebar-menu-link" data-page="statisticsPage">
            <i class="fas fa-chart-pie sidebar-menu-icon"></i>
            <span>ç»Ÿè®¡åˆ†æ</span>
          </a>
        </li>
        <li class="sidebar-menu-item">
          <a href="javascript:showPage('settingsPage')" class="sidebar-menu-link" data-page="settingsPage">
            <i class="fas fa-cog sidebar-menu-icon"></i>
            <span>ç³»ç»Ÿè®¾ç½®</span>
          </a>
        </li>
      </ul>
      
      <div class="sidebar-collapse">
        <button class="sidebar-collapse-btn" id="sidebarCollapseBtn">
          <i class="fas fa-angle-left"></i>
        </button>
      </div>
    </div>

    <!-- ç§»åŠ¨ç«¯é®ç½©å±‚ -->
    <div class="overlay" id="overlay"></div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
      <!-- ç§»åŠ¨ç«¯å¤´éƒ¨ -->
      <div class="mobile-header">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
          <i class="fas fa-bars"></i>
        </button>
        <div class="logo" style="margin-left: 10px;">
          <div class="logo-icon" style="width: 32px; height: 32px; font-size: 16px;">ğŸ“</div>
        </div>
      </div>

      <!-- é¡¶éƒ¨å¯¼èˆª -->
      <div class="header">
        <div class="header-actions" style="margin-right: auto;">
          <button class="btn btn-primary" id="refreshBtn">
            <i class="fas fa-sync-alt"></i>
            <span>åˆ·æ–°</span>
          </button>
        </div>
        
        <div class="header-actions">
          <button class="btn btn-success" id="addNumberBtn">
            <i class="fas fa-plus"></i>
            <span>æ–°å¢å·ç </span>
          </button>
          <button class="btn btn-primary" id="importBtn">
            <i class="fas fa-file-import"></i>
            <span>å¯¼å…¥</span>
          </button>
          <button class="btn btn-primary" id="exportBtn">
            <i class="fas fa-file-export"></i>
            <span>å¯¼å‡º</span>
          </button>
          
          <div class="theme-switch tooltip">
            <label class="switch">
              <input type="checkbox" id="themeToggle">
              <span class="slider"></span>
            </label>
            <span class="tooltip-text">åˆ‡æ¢ä¸»é¢˜</span>
          </div>
          
          <div class="user-info tooltip" id="userMenuBtn">
            <div class="user-avatar">JD</div>
            <span>ç®¡ç†å‘˜</span>
            <i class="fas fa-chevron-down" style="font-size: 12px;"></i>
            <span class="tooltip-text">ç”¨æˆ·èœå•</span>
          </div>
          
          <div class="settings-dropdown" id="userMenu">
            <div class="settings-section">
              <div class="settings-title">è´¦æˆ·</div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-user"></i> ä¸ªäººä¿¡æ¯</div>
              </div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-key"></i> ä¿®æ”¹å¯†ç </div>
              </div>
            </div>
            <div class="settings-section">
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-sign-out-alt"></i> é€€å‡ºç™»å½•</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- å†…å®¹åŒºåŸŸ -->
      <div class="content-wrapper">
        <!-- 1. å·ç åˆ—è¡¨é¡µ -->
        <div class="page active" id="listPage">
          <!-- ç»Ÿè®¡å¡ç‰‡ -->
          <div class="stats-container">
            <div class="stat-card">
              <div class="stat-title">
                <i class="fas fa-phone-alt"></i> æ€»å·ç æ•°
              </div>
              <div class="stat-value" id="totalCount">0</div>
              <div class="stat-desc">è¾ƒæ˜¨æ—¥ +0</div>
            </div>
            
            <div class="stat-card success">
              <div class="stat-title">
                <i class="fas fa-check-circle"></i> å·²åˆ†é…
              </div>
              <div class="stat-value" id="usedCount">0</div>
              <div class="stat-desc">
                <span class="stat-change positive">+0 ä»Šæ—¥</span>
              </div>
            </div>
            
            <div class="stat-card warning">
              <div class="stat-title">
                <i class="fas fa-clock"></i> æœªåˆ†é…
              </div>
              <div class="stat-value" id="unusedCount">0</div>
              <div class="stat-desc">
                å æ¯” <span id="unusedRatio">0%</span>
              </div>
            </div>
            
            <div class="stat-card danger">
              <div class="stat-title">
                <i class="fas fa-ban"></i> å·²åœç”¨
              </div>
              <div class="stat-value" id="disabledCount">0</div>
              <div class="stat-desc">
                <span class="stat-change negative">+0 æœ¬å‘¨</span>
              </div>
            </div>
          </div>

          <!-- ç­›é€‰åŒº -->
          <div class="filter-bar">
            <select class="select" id="statusFilter" style="width: auto; min-width: 140px;">
              <option value="">å…¨éƒ¨çŠ¶æ€</option>
              <option value="used">å·²åˆ†é…</option>
              <option value="unused">æœªåˆ†é…</option>
              <option value="disabled">å·²åœç”¨</option>
            </select>

            <select class="select" id="assigneeFilter" style="width: auto; min-width: 160px;">
              <option value="">å…¨éƒ¨äººå‘˜</option>
              <!-- äººå‘˜åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </select>

            <div style="flex: 1; position: relative;">
              <input type="text" class="input input-search" id="searchInput" 
                     placeholder="æœç´¢å·ç /å§“å/è¢«åˆ†é…äºº" style="padding-left: 36px;">
              <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);"></i>
            </div>

            <div class="filter-actions">
              <div class="saved-filters">
                <button class="btn btn-sm btn-default saved-filters-btn" id="savedFiltersBtn">
                  <i class="fas fa-filter"></i>
                  <span>ç­›é€‰</span>
                </button>
                <div class="filter-dropdown" id="savedFiltersDropdown">
                  <div class="filter-dropdown-item" data-filter="recent">
                    <span>æœ€è¿‘å¯¼å…¥</span>
                    <i class="fas fa-clock"></i>
                  </div>
                  <div class="filter-dropdown-item" data-filter="unassigned">
                    <span>æœªåˆ†é…å·ç </span>
                    <i class="fas fa-question-circle"><i class="fas fa-question-circle"></i>
                  </div>
                  <div class="filter-dropdown-divider"></div>
                  <div class="filter-dropdown-item" data-filter="save">
                    <span>ä¿å­˜å½“å‰ç­›é€‰</span>
                    <i class="fas fa-save"></i>
                  </div>
                </div>
              </div>
              
              <button class="btn btn-sm btn-default" id="resetFilterBtn">
                <i class="fas fa-redo-alt"></i>
                <span>é‡ç½®</span>
              </button>
            </div>
          </div>

          <!-- å·ç è¡¨æ ¼ -->
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <i class="fas fa-list-alt"></i> å·ç åˆ—è¡¨
              </div>
              <div>
                <span style="color: var(--text-tertiary); font-size: 13px;">
                  å…± <span id="tableCount">0</span> æ¡è®°å½•
                </span>
              </div>
            </div>

            <div class="table-wrapper">
              <table class="table">
                <thead>
                  <tr>
                    <th class="sortable" data-sort="id">åºå·</th>
                    <th class="sortable" data-sort="phoneNumber">ç¾å›½å·ç </th>
                    <th class="sortable" data-sort="name">å§“å</th>
                    <th class="sortable" data-sort="age">å¹´é¾„</th>
                    <th class="sortable" data-sort="assignee">è¢«åˆ†é…äºº</th>
                    <th class="sortable" data-sort="importTime">å¯¼å…¥æ—¶é—´</th>
                    <th class="sortable" data-sort="fileName">æ¥æºæ–‡ä»¶</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="numberTableBody">
                  <!-- è¡¨æ ¼å†…å®¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- 2. ç¼–è¾‘/æ–°å¢å·ç é¡µ -->
        <div class="page" id="editPage">
          <div class="card">
            <div class="card-header">
              <button class="btn btn-sm btn-default" onclick="returnToList()">
                <i class="fas fa-arrow-left"></i>
                <span>è¿”å›</span>
              </button>
              <div class="card-title" id="editTitle">ç¼–è¾‘å·ç </div>
            </div>

            <form class="form" id="editForm" onsubmit="saveNumber(event)">
              <input type="hidden" id="editId"> <!-- éšè—çš„IDå­—æ®µ -->
              <input type="hidden" id="editStatus" value="active"> <!-- çŠ¶æ€å­—æ®µ -->
              <input type="hidden" id="editFileName"> <!-- å¯¼å…¥æ–‡ä»¶åï¼ˆä»…å¯¼å…¥æ—¶è®¾ç½®ï¼‰ -->

              <div class="form-row">
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">ç¾å›½å·ç  <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="input" id="editPhone" placeholder="+1-XXX-XXX-XXXX" 
                          pattern="^\+1-\d{3}-\d{3}-\d{4}$" required>
                    <div class="form-hint">
                      <i class="fas fa-info-circle"></i> è¯·è¾“å…¥ç¾å›½å·ç ï¼Œæ ¼å¼ï¼š+1-XXX-XXX-XXXX
                    </div>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">å§“å <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="input" id="editName" placeholder="è¯·è¾“å…¥å§“å" required>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">å¹´é¾„ <span style="color: var(--danger);">*</span></label>
                    <input type="number" class="input" id="editAge" placeholder="è¯·è¾“å…¥å¹´é¾„" min="0" max="150" required>
                    <div class="form-hint">
                      <i class="fas fa-info-circle"></i> è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„ï¼ˆ0-150ï¼‰
                    </div>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">çŠ¶æ€ <span style="color: var(--danger);">*</span></label>
                    <select class="select" id="editStatusSelect" required>
                      <option value="active">æ­£å¸¸</option>
                      <option value="disabled">å·²åœç”¨</option>
                    </select>
                    <div class="form-hint">
                      <i class="fas fa-info-circle"></i> å·²åœç”¨çš„å·ç å°†ä¸ä¼šè¢«åˆ†é…æˆ–å¯¼å‡º
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-item">
                <label class="form-label">è¢«åˆ†é…äºº</label>
                <select class="select" id="editAssigneeSelect" style="margin-bottom: 10px;">
                  <option value="">æœªåˆ†é…</option>
                  <!-- äººå‘˜åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                </select>
                <div style="display: flex; gap: 10px;">
                  <input type="text" class="input" id="editAssigneeText" placeholder="æˆ–ç›´æ¥è¾“å…¥æ–°çš„è¢«åˆ†é…äºº">
                  <button type="button" class="btn btn-sm btn-primary" onclick="addPersonFromEdit()">
                    <i class="fas fa-plus"></i> æ·»åŠ 
                  </button>
                </div>
                <div class="form-hint">
                  <i class="fas fa-info-circle"></i> ä»å·²æœ‰äººå‘˜é€‰æ‹©æˆ–ç›´æ¥è¾“å…¥æ–°äººå‘˜
                </div>
              </div>

              <div class="form-item" id="importFileNameContainer" style="display: none;">
                <label class="form-label">æ¥æºæ–‡ä»¶</label>
                <input type="text" class="input" id="editDisplayFileName" disabled>
                <div class="form-hint">
                  <i class="fas fa-info-circle"></i> è¯¥å­—æ®µç”±ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œä¸å¯ä¿®æ”¹
                </div>
              </div>

              <div class="form-item">
                <label class="form-label">å¤‡æ³¨</label>
                <textarea class="textarea" id="editRemark" placeholder="æ·»åŠ å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-default" onclick="returnToList()">
                  <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> ä¿å­˜
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- 3. ä½¿ç”¨è®°å½•é¡µ -->
        <div class="page" id="logPage">
          <div class="card">
            <div class="card-header">
              <button class="btn btn-sm btn-default" onclick="returnToList()">
                <i class="fas fa-arrow-left"></i>
                <span>è¿”å›</span>
              </button>
              <div class="card-title" id="logTitle">å·ç ä½¿ç”¨è®°å½•</div>
            </div>

            <div id="logPhone" style="margin-bottom: 1.5rem; padding: 1rem; background-color: var(--bg-light); border-radius: var(--radius);"></div>
            
            <div class="timeline" id="timelineContainer">
              <!-- æ—¶é—´çº¿å†…å®¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
              <div class="timeline-item">
                <div class="timeline-dot">â„¹ï¸</div>
                <div class="timeline-content">
                  <div class="timeline-time">è¯·é€‰æ‹©ä¸€ä¸ªå·ç æŸ¥çœ‹è®°å½•</div>
                  <div class="timeline-title">ä½¿ç”¨è®°å½•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
                  <div class="timeline-detail">åŒ…æ‹¬å·ç çš„åˆ†é…ã€ä¿®æ”¹å’ŒçŠ¶æ€å˜æ›´å†å²</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 4. äººå‘˜ç®¡ç†é¡µ -->
        <div class="page" id="personPage">
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <i class="fas fa-users"></i> äººå‘˜ç®¡ç†
              </div>
              <button class="btn btn-success" onclick="showAddPersonForm()">
                <i class="fas fa-plus"></i>
                <span>æ–°å¢äººå‘˜</span>
              </button>
            </div>

            <div class="filter-bar" style="margin-bottom: 1rem;">
              <div style="flex: 1; position: relative;">
                <input type="text" class="input input-search" id="personSearchInput" 
                      placeholder="æœç´¢äººå‘˜å§“å/éƒ¨é—¨/å¤‡æ³¨" style="padding-left: 36px;">
                <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);"></i>
              </div>
              
              <select class="select" id="personDeptFilter" style="width: auto; min-width: 140px;">
                <option value="">å…¨éƒ¨éƒ¨é—¨</option>
                <option value="äºšé©¬é€Šå›¢é˜Ÿ">äºšé©¬é€Šå›¢é˜Ÿ</option>
                <option value="Shopifyå›¢é˜Ÿ">Shopifyå›¢é˜Ÿ</option>
                <option value="å®¢æœéƒ¨">å®¢æœéƒ¨</option>
                <option value="æŠ€æœ¯éƒ¨">æŠ€æœ¯éƒ¨</option>
              </select>
            </div>

            <div id="personListContainer" class="person-list">
              <!-- äººå‘˜åˆ—è¡¨ç”±JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
          </div>

          <!-- æ–°å¢/ç¼–è¾‘äººå‘˜è¡¨å• -->
          <div class="card" id="personFormCard" style="display: none;">
            <div class="card-header">
              <button class="btn btn-sm btn-default" onclick="hidePersonForm()">
                <i class="fas fa-arrow-left"></i>
                <span>è¿”å›</span>
              </button>
              <div class="card-title" id="personFormTitle">æ–°å¢äººå‘˜</div>
            </div>
            
            <form class="form" id="personForm" onsubmit="savePerson(event)">
              <input type="hidden" id="personId">

              <div class="form-row">
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">å§“å <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="input" id="personName" placeholder="è¯·è¾“å…¥äººå‘˜å§“å" required>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-item">
                    <label class="form-label">éƒ¨é—¨/å›¢é˜Ÿ <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="input" id="personPurpose" placeholder="å¦‚ï¼šäºšé©¬é€Šã€å®¢æœéƒ¨" required>
                  </div>
                </div>
              </div>

              <div class="form-item">
                <label class="form-label">è”ç³»æ–¹å¼</label>
                <input type="text" class="input" id="personContact" placeholder="ç”µè¯æˆ–é‚®ç®±ï¼ˆå¯é€‰ï¼‰">
              </div>

              <div class="form-item">
                <label class="form-label">å¤‡æ³¨</label>
                <textarea class="textarea" id="personRemark" placeholder="æ·»åŠ äººå‘˜ç›¸å…³å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-default" onclick="hidePersonForm()">
                  <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> ä¿å­˜
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- 5. ç»Ÿè®¡åˆ†æé¡µ -->
        <div class="page" id="statisticsPage">
          <div class="stats-container">
            <div class="stat-card">
              <div class="stat-title">
                <i class="fas fa-calendar-alt"></i> æœ¬æœˆæ–°å¢
              </div>
              <div class="stat-value" id="monthlyNew">0</div>
              <div class="stat-desc">
                <span class="stat-change positive">+0 ç¯æ¯”ä¸Šæœˆ</span>
              </div>
            </div>
            
            <div class="stat-card success">
              <div class="stat-title">
                <i class="fas fa-percentage"></i> åˆ†é…ç‡
              </div>
              <div class="stat-value" id="assignmentRate">0%</div>
              <div class="stat-desc">
                <span class="stat-change positive">+0% ç¯æ¯”ä¸Šå‘¨</span>
              </div>
            </div>
            
            <div class="stat-card warning">
              <div class="stat-title">
                <i class="fas fa-exchange-alt"></i> å‘¨è½¬ç‡
              </div>
              <div class="stat-value" id="turnoverRate">0</div>
              <div class="stat-desc">
                æœ¬æœˆæ›´æ¢åˆ†é… 0 æ¬¡
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-col">
              <div class="card">
                <div class="card-header">
                  <div class="card-title">
                    <i class="fas fa-chart-bar"></i> éƒ¨é—¨åˆ†é…ç»Ÿè®¡
                  </div>
                </div>
                <div style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-tertiary);" id="deptChart">
                  <div>éƒ¨é—¨åˆ†é…ç»Ÿè®¡å›¾è¡¨</div>
                </div>
              </div>
            </div>
            <div class="form-col">
              <div class="card">
                <div class="card-header">
                  <div class="card-title">
                    <i class="fas fa-chart-line"></i> å¯¼å…¥è¶‹åŠ¿
                  </div>
                </div>
                <div style="height: 300px; display: flex; align-items: center; justify-content: center; color: var(--text-tertiary);" id="importTrendChart">
                  <div>å¯¼å…¥è¶‹åŠ¿å›¾è¡¨</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <i class="fas fa-trophy"></i> éƒ¨é—¨æ•ˆç‡æ’è¡Œ
              </div>
            </div>
            <div class="table-wrapper">
              <table class="table">
                <thead>
                  <tr>
                    <th>æ’å</th>
                    <th>éƒ¨é—¨</th>
                    <th>åˆ†é…æ•°é‡</th>
                    <th>ä½¿ç”¨ç‡</th>
                    <th>å¹³å‡ä½¿ç”¨æ—¶é•¿</th>
                  </tr>
                </thead>
                <tbody id="deptRankingBody">
                  <!-- éƒ¨é—¨æ’è¡Œç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- 6. ç³»ç»Ÿè®¾ç½®é¡µ -->
        <div class="page" id="settingsPage">
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <i class="fas fa-cog"></i> ç³»ç»Ÿè®¾ç½®
              </div>
            </div>
            
            <div class="settings-section">
              <div class="settings-title">ç•Œé¢è®¾ç½®</div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-moon"></i> æ·±è‰²æ¨¡å¼</div>
                <label class="switch">
                  <input type="checkbox" id="darkModeToggle">
                  <span class="slider"></span>
                </label>
              </div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-compress-arrows-alt"></i> ç´§å‡‘å¸ƒå±€</div>
                <label class="switch">
                  <input type="checkbox" id="compactLayoutToggle">
                  <span class="slider"></span>
                </label>
              </div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-language"></i> è¯­è¨€è®¾ç½®</div>
                <select class="select" style="width: auto;">
                  <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                  <option value="en">English</option>
                </select>
              </div>
            </div>
            
            <div class="settings-section">
              <div class="settings-title">æ•°æ®è®¾ç½®</div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-clock"></i> è‡ªåŠ¨åˆ·æ–°æ—¶é—´</div>
                <select class="select" style="width: auto;">
                  <option value="0">ä¸è‡ªåŠ¨åˆ·æ–°</option>
                  <option value="30">30ç§’</option>
                  <option value="60" selected>1åˆ†é’Ÿ</option>
                  <option value="300">5åˆ†é’Ÿ</option>
                </select>
              </div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-history"></i> æ—¥å¿—ä¿ç•™æ—¶é—´</div>
                <select class="select" style="width: auto;">
                  <option value="30">30å¤©</option>
                  <option value="90" selected>90å¤©</option>
                  <option value="180">180å¤©</option>
                  <option value="365">1å¹´</option>
                </select>
              </div>
            </div>
            
            <div class="settings-section">
              <div class="settings-title">å¯¼å…¥å¯¼å‡ºè®¾ç½®</div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-file-export"></i> é»˜è®¤å¯¼å‡ºæ ¼å¼</div>
                <select class="select" style="width: auto;">
                  <option value="csv" selected>CSV</option>
                  <option value="txt">TXT</option>
                  <option value="xlsx">Excel</option>
                </select>
              </div>
              <div class="settings-item">
                <div class="settings-label"><i class="fas fa-shield-alt"></i> å¯¼å‡ºåŠ å¯†</div>
                <label class="switch">
                  <input type="checkbox" id="exportEncryptionToggle">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn btn-default">
                <i class="fas fa-undo"></i> æ¢å¤é»˜è®¤
              </button>
              <button type="button" class="btn btn-primary">
                <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- æ‰¹é‡å¯¼å…¥æ¨¡æ€æ¡† -->
  <div class="modal-backdrop" id="importModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-file-import"></i> æ‰¹é‡å¯¼å…¥å·ç 
        </div>
        <button class="modal-close" onclick="closeImportModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <!-- å¯¼å…¥æ–¹å¼é€‰é¡¹å¡ -->
        <div class="import-tabs">
          <div class="import-tab active" data-tab="file">æ–‡ä»¶å¯¼å…¥</div>
          <div class="import-tab" data-tab="paste">ç²˜è´´å¯¼å…¥</div>
          <div class="import-tab-indicator" id="importTabIndicator"></div>
        </div>
        
        <!-- æ–‡ä»¶å¯¼å…¥å†…å®¹ -->
        <div class="import-tab-content active" id="fileImportContent">
          <div class="form-item">
            <label class="form-label">é€‰æ‹©CSVæ–‡ä»¶</label>
            <input type="file" class="input" id="importFile" accept=".csv">
            <div class="form-hint">
              <i class="fas fa-info-circle"></i> æ”¯æŒæ ¼å¼ï¼š.csvï¼Œæœ€å¤§1000æ¡æ•°æ®
            </div>
          </div>
          
          <div class="form-item">
            <label class="form-label">é»˜è®¤è¢«åˆ†é…äººï¼ˆå¯é€‰ï¼‰</label>
            <select class="select" id="defaultAssignee">
              <option value="">ä¸è®¾ç½®é»˜è®¤å€¼</option>
              <!-- äººå‘˜åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </select>
            <div class="form-hint">
              <i class="fas fa-info-circle"></i> å¦‚CSVæ–‡ä»¶ä¸­æœªæŒ‡å®šè¢«åˆ†é…äººï¼Œå°†ä½¿ç”¨æ­¤é»˜è®¤å€¼
            </div>
          </div>
          
          <div class="form-item">
            <label class="form-label">å¯¼å…¥åçŠ¶æ€</label>
            <select class="select" id="importStatus">
              <option value="active" selected>æ­£å¸¸</option>
              <option value="disabled">å·²åœç”¨</option>
            </select>
          </div>
          
          <div class="import-template">
            <div class="import-template-title">
              <i class="fas fa-file-alt"></i> æ–‡ä»¶å¯¼å…¥æ ¼å¼è¯´æ˜
            </div>
            <div>æ”¯æŒçš„å­—æ®µï¼ˆé¡ºåºå¿…é¡»ä¸€è‡´ï¼‰ï¼š</div>
            <div class="import-fields">
              <span class="import-field">phoneNumberï¼ˆå¿…å¡«ï¼‰</span>
              <span class="import-field">nameï¼ˆå¿…å¡«ï¼‰</span>
              <span class="import-field">ageï¼ˆå¿…å¡«ï¼‰</span>
              <span class="import-field">assigneeï¼ˆå¯é€‰ï¼‰</span>
            </div>
            <div>ç¤ºä¾‹ï¼š+1-212-555-1234,å¼ ä¸‰,30,äºšé©¬é€Šå›¢é˜Ÿ</div>
            <button class="btn btn-sm btn-primary" style="margin-top: 10px;" onclick="downloadImportTemplate()">
              <i class="fas fa-download"></i> ä¸‹è½½æ¨¡æ¿
            </button>
          </div>
        </div>
        
        <!-- ç²˜è´´å¯¼å…¥å†…å®¹ -->
        <div class="import-tab-content" id="pasteImportContent">
          <div class="form-item">
            <label class="form-label">ç²˜è´´æ•°æ®</label>
            <textarea class="paste-area" id="pasteData" placeholder="è¯·æŒ‰ä»¥ä¸‹æ ¼å¼ç²˜è´´æ•°æ®ï¼Œæ¯è¡Œä¸€æ¡è®°å½•ï¼š
ç¾å›½å·ç ,å§“å,å¹´é¾„,è¢«åˆ†é…äººï¼ˆå¯é€‰ï¼‰
ä¾‹å¦‚ï¼š
+1-212-555-1234,å¼ ä¸‰,30,äºšé©¬é€Šå›¢é˜Ÿ
+1-310-555-6789,æå››,28
+1-773-555-4321,ç‹äº”,35,Shopifyå›¢é˜Ÿ"></textarea>
            <div class="form-hint">
              <i class="fas fa-info-circle"></i> æ¯è¡Œä¸€æ¡è®°å½•ï¼Œå­—æ®µç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œè¢«åˆ†é…äººå¯çœç•¥
            </div>
            <button class="btn btn-sm btn-primary" onclick="parsePasteData()">
              <i class="fas fa-magic"></i> è§£ææ•°æ®
            </button>
          </div>
          
          <!-- æ•°æ®é¢„è§ˆåŒºåŸŸ -->
          <div id="pastePreviewContainer" style="display: none;">
            <div class="form-hint" style="margin-bottom: 10px;">æ•°æ®é¢„è§ˆï¼ˆå…± <span id="previewCount">0</span> æ¡ï¼‰</div>
            <div class="paste-preview">
              <div class="paste-preview-header paste-preview-row">
                <div>åºå·</div>
                <div>ç¾å›½å·ç </div>
                <div>å§“å</div>
                <div>å¹´é¾„</div>
                <div>è¢«åˆ†é…äºº</div>
              </div>
              <div id="pastePreviewContent"></div>
            </div>
            <div id="pasteErrors" class="paste-error"></div>
          </div>
          
          <div class="form-row" style="margin-top: 1rem;">
            <div class="form-col">
              <div class="form-item">
                <label class="form-label">ç»Ÿä¸€åˆ†é…ç»™ï¼ˆå¯é€‰ï¼‰</label>
                <select class="select" id="pasteAssignee">
                  <option value="">ä¸åˆ†é…</option>
                  <!-- äººå‘˜åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                </select>
                <div class="form-hint">
                  <i class="fas fa-info-circle"></i> é€‰æ‹©åå°†è¦†ç›–ç²˜è´´æ•°æ®ä¸­çš„è¢«åˆ†é…äººä¿¡æ¯
                </div>
              </div>
            </div>
            <div class="form-col">
              <div class="form-item">
                <label class="form-label">å¯¼å…¥åçŠ¶æ€</label>
                <select class="select" id="pasteImportStatus">
                  <option value="active" selected>æ­£å¸¸</option>
                  <option value="disabled">å·²åœç”¨</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" onclick="closeImportModal()">
          <i class="fas fa-times"></i> å–æ¶ˆ
        </button>
        <button class="btn btn-primary" onclick="doImport()">
          <i class="fas fa-check"></i> å¼€å§‹å¯¼å…¥
        </button>
      </div>
    </div>
  </div>

  <!-- æ‰¹é‡å¯¼å‡ºæ¨¡æ€æ¡† -->
  <div class="modal-backdrop" id="exportModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-file-export"></i> æ‰¹é‡å¯¼å‡ºå·ç 
        </div>
        <button class="modal-close" onclick="closeExportModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-item">
          <label class="form-label">é€‰æ‹©å¯¼å‡ºå­—æ®µ</label>
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin-top: 10px;">
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportPhone"> ç¾å›½å·ç 
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportName"> å§“å
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportAge"> å¹´é¾„
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportAssignee"> è¢«åˆ†é…äºº
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportImportTime"> å¯¼å…¥æ—¶é—´
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" checked id="exportFileName"> æ¥æºæ–‡ä»¶
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" id="exportRemark"> å¤‡æ³¨
            </label>
          </div>
        </div>
        
        <div class="form-item">
          <label class="form-label">å¯¼å‡ºèŒƒå›´</label>
          <select class="select" id="exportRange">
            <option value="filtered">å½“å‰ç­›é€‰ç»“æœ</option>
            <option value="all">å…¨éƒ¨å·ç </option>
            <option value="random">éšæœºæœªåˆ†é…å·ç </option>
          </select>
          
          <!-- è‡ªå®šä¹‰æ•°é‡è¾“å…¥åŒºåŸŸ -->
          <div class="custom-amount-container hidden" id="customAmountContainer">
            <div class="amount-input-group">
              <span>æ•°é‡ï¼š</span>
              <input type="number" class="input amount-input" id="randomExportAmount" min="1" value="50">
            </div>
            <div class="amount-info">
              <i class="fas fa-info-circle"></i> å°†ä»æ‰€æœ‰æœªåˆ†é…å·ç ä¸­éšæœºé€‰æ‹©æŒ‡å®šæ•°é‡å¯¼å‡º
            </div>
          </div>
        </div>
        
        <div class="form-item">
          <label class="form-label">å¯¼å‡ºæ ¼å¼</label>
          <select class="select" id="exportFormat">
            <option value="csv">CSVï¼ˆæ¨èï¼‰</option>
            <option value="txt">TXTï¼ˆæ¯è¡Œä¸€æ¡è®°å½•ï¼‰</option>
            <option value="xlsx">Excel</option>
          </select>
        </div>
        
        <div class="form-item">
          <label class="form-label">å¯¼å‡ºé€‰é¡¹</label>
          <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" id="exportWithHeader" checked> åŒ…å«æ ‡é¢˜è¡Œ
            </label>
            <label style="display: flex; align-items: center; gap: 5px;">
              <input type="checkbox" id="exportEncrypt"> åŠ å¯†å¯¼å‡º
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" onclick="closeExportModal()">
          <i class="fas fa-times"></i> å–æ¶ˆ
        </button>
        <button class="btn btn-primary" onclick="doExport()">
          <i class="fas fa-check"></i> å¼€å§‹å¯¼å‡º
        </button>
      </div>
    </div>
  </div>

  <!-- æç¤ºæ¡†ç»„ä»¶ -->
  <div class="toast" id="toast">
    <i class="fas fa-info-circle"></i>
    <span id="toastMessage"></span>
  </div>
  
  <!-- åŠ è½½åŠ¨ç”» -->
  <div class="loading" id="loading">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">å¤„ç†ä¸­...</div>
  </div>

  <script>
    // å…¨å±€æ•°æ®å­˜å‚¨
    let numberList = [];    // å·ç åˆ—è¡¨
    let logList = [];       // æ“ä½œæ—¥å¿—
    let personList = [];    // äººå‘˜åˆ—è¡¨
    let parsedPasteData = []; // è§£æåçš„ç²˜è´´æ•°æ®
    let savedFilters = [];  // ä¿å­˜çš„ç­›é€‰æ¡ä»¶
    let currentSortField = 'id'; // å½“å‰æ’åºå­—æ®µ
    let currentSortDirection = 'asc'; // å½“å‰æ’åºæ–¹å‘

    // åˆå§‹åŒ–é¡µé¢
    window.onload = function() {
      // åˆå§‹åŒ–UIäº¤äº’ç»„ä»¶
      initUIComponents();
      
      showLoading("åŠ è½½æ•°æ®ä¸­...");
      // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
      loadAllData();
      // æ¸²æŸ“åˆ—è¡¨
      renderNumberList();
      renderPersonList();
      updatePersonSelectors();
      renderStatistics();
      hideLoading();
    };

    // åˆå§‹åŒ–UIç»„ä»¶äº¤äº’
    function initUIComponents() {
      // ä¾§è¾¹æ æŠ˜å /å±•å¼€
      const sidebar = document.getElementById('sidebar');
      const sidebarCollapseBtn = document.getElementById('sidebarCollapseBtn');
      const sidebarLogoText = document.querySelector('#sidebarLogo span');
      const menuTexts = document.querySelectorAll('.sidebar-menu-link span');
      
      sidebarCollapseBtn.addEventListener('click', function() {
        sidebar.classList.toggle('collapsed');
        const icon = sidebarCollapseBtn.querySelector('i');
        
        if (sidebar.classList.contains('collapsed')) {
          icon.classList.remove('fa-angle-left');
          icon.classList.add('fa-angle-right');
          sidebarLogoText.style.display = 'none';
          menuTexts.forEach(text => text.style.display = 'none');
        } else {
          icon.classList.remove('fa-angle-right');
          icon.classList.add('fa-angle-left');
          sidebarLogoText.style.display = 'inline';
          menuTexts.forEach(text => text.style.display = 'inline');
        }
      });
      
      // ç§»åŠ¨ç«¯èœå•
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const overlay = document.getElementById('overlay');
      
      mobileMenuBtn.addEventListener('click', function() {
        sidebar.classList.add('show');
        overlay.classList.add('show');
      });
      
      overlay.addEventListener('click', function() {
        sidebar.classList.remove('show');
        overlay.classList.remove('show');
      });
      
      // èœå•ç‚¹å‡»äº‹ä»¶
      document.querySelectorAll('.sidebar-menu-link').forEach(link => {
        link.addEventListener('click', function() {
          document.querySelectorAll('.sidebar-menu-link').forEach(l => {
            l.classList.remove('active');
          });
          this.classList.add('active');
          
          // ç§»åŠ¨ç«¯è‡ªåŠ¨å…³é—­èœå•
          if (window.innerWidth <= 768) {
            sidebar.classList.remove('show');
            overlay.classList.remove('show');
          }
        });
      });
      
      // å¯¼å…¥é€‰é¡¹å¡åˆ‡æ¢
      const importTabs = document.querySelectorAll('.import-tab');
      const importTabIndicator = document.getElementById('importTabIndicator');
      
      importTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const tabName = this.getAttribute('data-tab');
          
          // åˆ‡æ¢é€‰é¡¹å¡æ¿€æ´»çŠ¶æ€
          importTabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          
          // åˆ‡æ¢å†…å®¹æ˜¾ç¤º
          document.querySelectorAll('.import-tab-content').forEach(content => {
            content.classList.remove('active');
          });
          document.getElementById(`${tabName}ImportContent`).classList.add('active');
          
          // ç§»åŠ¨æŒ‡ç¤ºå™¨
          const tabWidth = this.offsetWidth;
          const tabLeft = this.offsetLeft;
          importTabIndicator.style.width = `${tabWidth}px`;
          importTabIndicator.style.left = `${tabLeft}px`;
        });
      });
      
      // åˆå§‹åŒ–é€‰é¡¹å¡æŒ‡ç¤ºå™¨ä½ç½®
      setTimeout(() => {
        const activeTab = document.querySelector('.import-tab.active');
        const tabWidth = activeTab.offsetWidth;
        const tabLeft = activeTab.offsetLeft;
        importTabIndicator.style.width = `${tabWidth}px`;
        importTabIndicator.style.left = `${tabLeft}px`;
      }, 100);
      
      // ç­›é€‰ä¸‹æ‹‰èœå•
      const savedFiltersBtn = document.getElementById('savedFiltersBtn');
      const savedFiltersDropdown = document.getElementById('savedFiltersDropdown');
      
      savedFiltersBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        savedFiltersDropdown.classList.toggle('show');
      });
      
      document.addEventListener('click', function() {
        savedFiltersDropdown.classList.remove('show');
      });
      
      // ç­›é€‰é¡¹ç‚¹å‡»
      document.querySelectorAll('.filter-dropdown-item').forEach(item => {
        item.addEventListener('click', function() {
          const filterType = this.getAttribute('data-filter');
          
          if (filterType === 'recent') {
            // æœ€è¿‘å¯¼å…¥ç­›é€‰
            filterRecentImported();
          } else if (filterType === 'unassigned') {
            // æœªåˆ†é…ç­›é€‰
            filterUnassigned();
          } else if (filterType === 'save') {
            // ä¿å­˜å½“å‰ç­›é€‰
            saveCurrentFilter();
          }
          
          savedFiltersDropdown.classList.remove('show');
        });
      });
      
      // é‡ç½®ç­›é€‰æŒ‰é’®
      document.getElementById('resetFilterBtn').addEventListener('click', function() {
        document.getElementById('statusFilter').value = '';
        document.getElementById('assigneeFilter').value = '';
        document.getElementById('searchInput').value = '';
        filterNumbers();
      });
      
      // è¡¨æ ¼æ’åº
      document.querySelectorAll('.table th.sortable').forEach(header => {
        header.addEventListener('click', function() {
          const field = this.getAttribute('data-sort');
          
          // é‡ç½®æ‰€æœ‰æ’åºæŒ‡ç¤º
          document.querySelectorAll('.table th.sortable').forEach(h => {
            h.classList.remove('sort-asc', 'sort-desc');
          });
          
          // è®¾ç½®æ’åºæ–¹å‘
          if (currentSortField === field) {
            currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
          } else {
            currentSortField = field;
            currentSortDirection = 'asc';
          }
          
          // æ·»åŠ æ’åºæŒ‡ç¤º
          this.classList.add(`sort-${currentSortDirection}`);
          
          // é‡æ–°ç­›é€‰å’Œæ’åº
          filterNumbers();
        });
      });
      
      // ç”¨æˆ·èœå•
      const userMenuBtn = document.getElementById('userMenuBtn');
      const userMenu = document.getElementById('userMenu');
      
      userMenuBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        userMenu.classList.toggle('show');
      });
      
      document.addEventListener('click', function() {
        userMenu.classList.remove('show');
      });
      
      // å¿«æ·æŒ‰é’®ç»‘å®š
      document.getElementById('addNumberBtn').addEventListener('click', showAddForm);
      document.getElementById('importBtn').addEventListener('click', openImportModal);
      document.getElementById('exportBtn').addEventListener('click', openExportModal);
      document.getElementById('refreshBtn').addEventListener('click', refreshList);
      
      // ä¸»é¢˜åˆ‡æ¢
      const themeToggle = document.getElementById('themeToggle');
      themeToggle.addEventListener('change', function() {
        if (this.checked) {
          document.body.classList.add('dark-mode');
          showToast('å·²åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼', 'success');
        } else {
          document.body.classList.remove('dark-mode');
          showToast('å·²åˆ‡æ¢è‡³æµ…è‰²æ¨¡å¼', 'success');
        }
      });
      
      // å¯¼å‡ºèŒƒå›´é€‰æ‹©å˜åŒ–äº‹ä»¶ - æ˜¾ç¤º/éšè—è‡ªå®šä¹‰æ•°é‡è¾“å…¥
      const exportRange = document.getElementById('exportRange');
      const customAmountContainer = document.getElementById('customAmountContainer');
      
      exportRange.addEventListener('change', function() {
        if (this.value === 'random') {
          customAmountContainer.classList.remove('hidden');
        } else {
          customAmountContainer.classList.add('hidden');
        }
      });
    }

    // é¡µé¢åˆ‡æ¢ - è¿”å›åˆ—è¡¨é¡µ
    function returnToList() {
      showToast("è¿”å›åˆ—è¡¨", "success");
      showPage('listPage');
    }

    // é€šç”¨é¡µé¢åˆ‡æ¢
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      document.getElementById(pageId).classList.add('active');
      
      // æ›´æ–°ä¾§è¾¹æ é€‰ä¸­çŠ¶æ€
      document.querySelectorAll('.sidebar-menu-link').forEach(link => {
        if (link.getAttribute('data-page') === pageId) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
      
      // å¦‚æœåˆ‡æ¢åˆ°äººå‘˜é¡µé¢ï¼Œé‡æ–°æ¸²æŸ“äººå‘˜åˆ—è¡¨
      if (pageId === 'personPage') {
        renderPersonList();
      }
      
      // å¦‚æœåˆ‡æ¢åˆ°ç»Ÿè®¡é¡µé¢ï¼Œé‡æ–°æ¸²æŸ“ç»Ÿè®¡æ•°æ®
      if (pageId === 'statisticsPage') {
        renderStatistics();
      }
    }

    // ç­›é€‰æœ€è¿‘å¯¼å…¥çš„æ•°æ®ï¼ˆè¿‘7å¤©ï¼‰
    function filterRecentImported() {
      const sevenDaysAgo = new Date();
      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
      
      document.getElementById('statusFilter').value = '';
      document.getElementById('assigneeFilter').value = '';
      document.getElementById('searchInput').value = '';
      
      const filtered = numberList.filter(item => {
        const importDate = new Date(item.importTime);
        return importDate >= sevenDaysAgo;
      });
      
      renderNumberList(filtered);
      showToast('å·²ç­›é€‰æœ€è¿‘7å¤©å¯¼å…¥çš„æ•°æ®', 'info');
    }

    // ç­›é€‰æœªåˆ†é…çš„æ•°æ®
    function filterUnassigned() {
      document.getElementById('statusFilter').value = 'unused';
      document.getElementById('assigneeFilter').value = '';
      document.getElementById('searchInput').value = '';
      
      const filtered = numberList.filter(item => !item.assignee && item.status !== 'disabled');
      renderNumberList(filtered);
      showToast('å·²ç­›é€‰æœªåˆ†é…çš„å·ç ', 'info');
    }

    // ä¿å­˜å½“å‰ç­›é€‰æ¡ä»¶
    function saveCurrentFilter() {
      const statusFilter = document.getElementById('statusFilter').value;
      const assigneeFilter = document.getElementById('assigneeFilter').value;
      const searchKeyword = document.getElementById('searchInput').value;
      
      // ç”Ÿæˆç­›é€‰åç§°
      let filterName = '';
      if (statusFilter === 'used') filterName += 'å·²åˆ†é…';
      else if (statusFilter === 'unused') filterName += 'æœªåˆ†é…';
      else if (statusFilter === 'disabled') filterName += 'å·²åœç”¨';
      
      if (assigneeFilter) {
        filterName += (filterName ? ' - ' : '') + assigneeFilter;
      }
      
      if (searchKeyword) {
        filterName += (filterName ? ' - ' : '') + 'æœç´¢: ' + searchKeyword.substring(0, 10);
      }
      
      if (!filterName) {
        filterName = 'å…¨éƒ¨æ•°æ®';
      }
      
      // æç¤ºç”¨æˆ·è¾“å…¥ç­›é€‰åç§°
      const customName = prompt('è¯·è¾“å…¥ç­›é€‰æ¡ä»¶åç§°:', filterName);
      if (!customName) return;
      
      // ä¿å­˜ç­›é€‰æ¡ä»¶
      const newFilter = {
        id: Date.now(),
        name: customName,
        status: statusFilter,
        assignee: assigneeFilter,
        keyword: searchKeyword
      };
      
      savedFilters.push(newFilter);
      showToast(`å·²ä¿å­˜ç­›é€‰æ¡ä»¶: ${customName}`, 'success');
      
      // è¿™é‡Œå¯ä»¥å°†savedFiltersä¿å­˜åˆ°localStorage
      localStorage.setItem('savedFilters', JSON.stringify(savedFilters));
    }

    // è§£æç²˜è´´çš„æ•°æ®
    function parsePasteData() {
      const pasteData = document.getElementById('pasteData').value.trim();
      if (!pasteData) {
        showToast("è¯·è¾“å…¥è¦è§£æçš„æ•°æ®", "error");
        return;
      }
      
      parsedPasteData = [];
      const lines = pasteData.split('\n');
      const errors = [];
      
      lines.forEach((line, index) => {
        const lineNumber = index + 1;
        const trimmedLine = line.trim();
        if (!trimmedLine) return;
        
        const fields = trimmedLine.split(',');
        let phoneNumber, name, age, assignee = '';
        
        // è§£æå­—æ®µ
        if (fields.length >= 3) {
          phoneNumber = fields[0].trim();
          name = fields[1].trim();
          age = fields[2].trim();
          if (fields.length >= 4) assignee = fields[3].trim();
        } else {
          errors.push(`ç¬¬ ${lineNumber} è¡Œï¼šæ•°æ®æ ¼å¼é”™è¯¯ï¼Œè‡³å°‘éœ€è¦åŒ…å«3ä¸ªå­—æ®µï¼ˆå·ç ,å§“å,å¹´é¾„ï¼‰`);
          return;
        }
        
        // éªŒè¯å·ç æ ¼å¼
        const phonePattern = /^\+1-\d{3}-\d{3}-\d{4}$/;
        if (!phonePattern.test(phoneNumber)) {
          errors.push(`ç¬¬ ${lineNumber} è¡Œï¼šå·ç æ ¼å¼é”™è¯¯ï¼Œåº”ä¸º +1-XXX-XXX-XXXX`);
        }
        
        // éªŒè¯å§“å
        if (!name) {
          errors.push(`ç¬¬ ${lineNumber} è¡Œï¼šå§“åä¸èƒ½ä¸ºç©º`);
        }
        
        // éªŒè¯å¹´é¾„
        const ageNum = parseInt(age);
        if (isNaN(ageNum) || ageNum < 0 || ageNum > 150) {
          errors.push(`ç¬¬ ${lineNumber} è¡Œï¼šå¹´é¾„å¿…é¡»æ˜¯0-150ä¹‹é—´çš„æ•°å­—`);
        }
        
        // æ·»åŠ åˆ°è§£ææ•°æ®åˆ—è¡¨
        parsedPasteData.push({
          phoneNumber,
          name,
          age: ageNum,
          assignee,
          isValid: errors.filter(e => e.startsWith(`ç¬¬ ${lineNumber} è¡Œ`)).length === 0
        });
      });
      
      // æ˜¾ç¤ºé¢„è§ˆ
      document.getElementById('pastePreviewContainer').style.display = 'block';
      document.getElementById('previewCount').textContent = parsedPasteData.length;
      
      // æ¸²æŸ“é¢„è§ˆå†…å®¹
      const previewContent = document.getElementById('pastePreviewContent');
      previewContent.innerHTML = '';
      
      parsedPasteData.forEach((item, index) => {
        const row = document.createElement('div');
        row.className = `paste-preview-row ${item.isValid ? '' : 'error'}`;
        
        row.innerHTML = `
          <div>${index + 1}</div>
          <div>${item.phoneNumber}</div>
          <div>${item.name}</div>
          <div>${item.age}</div>
          <div>${item.assignee || '-'}</div>
        `;
        
        previewContent.appendChild(row);
      });
      
      // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      const errorContainer = document.getElementById('pasteErrors');
      if (errors.length > 0) {
        errorContainer.innerHTML = `<i class="fas fa-exclamation-circle"></i> å‘ç° ${errors.length} ä¸ªé”™è¯¯ï¼š${errors.join('ï¼›')}`;
      } else {
        errorContainer.textContent = '';
      }
    }

    // åŠ è½½æ‰€æœ‰æ•°æ®
    function loadAllData() {
      // ä»æœ¬åœ°å­˜å‚¨è·å–ï¼Œæ²¡æœ‰åˆ™åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®
      const savedNumbers = localStorage.getItem('usNumbers');
      const savedLogs = localStorage.getItem('usLogs');
      const savedPersons = localStorage.getItem('usPersons');
      const savedFiltersData = localStorage.getItem('savedFilters');

      // åŠ è½½å·ç æ•°æ®
      if (savedNumbers) {
        numberList = JSON.parse(savedNumbers);
      } else {
        // åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®ï¼ˆåŒ…å«æ‰€æœ‰è¦æ±‚çš„å­—æ®µï¼‰
        numberList = [
          { 
            id: 1, 
            phoneNumber: "+1-212-555-1234", 
            name: "å¼ ä¸‰",
            age: 30,
            assignee: "äºšé©¬é€Šå›¢é˜Ÿ", 
            importTime: "2024-09-20 15:30",
            fileName: "initial_data.csv",
            status: "active",
            remark: "ä¸»è¦ç”¨äºåŒ—ç¾å¸‚åœº"
          },
          { 
            id: 2, 
            phoneNumber: "+1-310-555-6789", 
            name: "æå››",
            age: 28,
            assignee: "", 
            importTime: "2024-09-21 10:15",
            fileName: "initial_data.csv",
            status: "active",
            remark: ""
          },
          { 
            id: 3, 
            phoneNumber: "+1-773-555-4321", 
            name: "ç‹äº”",
            age: 35,
            assignee: "Shopifyå›¢é˜Ÿ", 
            importTime: "2024-09-21 14:00",
            fileName: "october_batch.csv",
            status: "active",
            remark: "å¤‡ç”¨å·ç "
          },
          { 
            id: 4, 
            phoneNumber: "+1-415-555-9876", 
            name: "èµµå…­",
            age: 25,
            assignee: "", 
            importTime: "2024-09-22 09:45",
            fileName: "october_batch.csv",
            status: "disabled",
            remark: "å·²åœç”¨"
          },
          { 
            id: 5, 
            phoneNumber: "+1-202-555-5678", 
            name: "é’±ä¸ƒ",
            age: 40,
            assignee: "", 
            importTime: "2024-09-22 11:30",
            fileName: "october_batch.csv",
            status: "active",
            remark: ""
          },
          { 
            id: 6, 
            phoneNumber: "+1-323-555-4321", 
            name: "å­™å…«",
            age: 32,
            assignee: "", 
            importTime: "2024-09-22 14:20",
            fileName: "october_batch.csv",
            status: "active",
            remark: ""
          }
        ];
        saveNumbersToStorage();
      }

      // åŠ è½½æ—¥å¿—æ•°æ®
      if (savedLogs) {
        logList = JSON.parse(savedLogs);
      } else {
        logList = [
          { id: 1, numberId: 1, action: "åˆ†é…", content: "åˆ†é…ç»™ äºšé©¬é€Šå›¢é˜Ÿ", time: "2024-09-20 15:30", type: "used", operator: "ç®¡ç†å‘˜" },
          { id: 2, numberId: 3, action: "åˆ†é…", content: "åˆ†é…ç»™ Shopifyå›¢é˜Ÿ", time: "2024-09-21 14:00", type: "used", operator: "ç®¡ç†å‘˜" },
          { id: 3, numberId: 4, action: "åœç”¨", content: "æ‰‹åŠ¨æ ‡è®°ä¸ºå·²åœç”¨", time: "2024-09-22 10:30", type: "deleted", operator: "ç®¡ç†å‘˜" }
        ];
        saveLogsToStorage();
      }

      // åŠ è½½äººå‘˜æ•°æ®
      if (savedPersons) {
